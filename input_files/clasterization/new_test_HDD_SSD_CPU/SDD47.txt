
Тестирование RAID0 из пары SSD с интерфейсом SATA
Оглавление

    Методика и объекты тестирования
    Производительность в приложениях
    Последовательные операции
    Случайный доступ
    Работа с большими файлами
    Рейтинги
    Итого

Методика тестирования накопителей образца 2018 года
Тестирование RAID0 из пары SSD с интерфейсом PCIe на LGA1151

Недавно мы попробовали «поиграть» с массивами RAID0 из пары NVMe-накопителей и пришли к выводу, что это лишено практического смысла. Точнее, смысл может быть лишь в том случае, когда массив создается из двух одинаковых топовых устройств, а возможность просто купить аналогичное устройство соответствующей емкости физически отсутствует. Да и то речь, скорее всего, будет идти только о «набивании попугаев», поскольку для прикладного программного обеспечения скоростные возможности даже бюджетных твердотельных накопителей избыточны. И даже если вдруг окажется, что старого маленького медленного SSD уже как-то не хватает, его проще заменить на новый большой и быстрый, а не пытаться докупить второй старый маленький медленный, дабы объединить их в RAID-массив.

С другой стороны, такой подход не всегда реализуем. Возьмем, например, старый SATA SSD: очевидным путем его модернизации является переход на NVMe, но в старой системе он не всегда возможен. Кроме того, менять, например, полтерабайта MLC с SATA-интерфейсом на терабайт TLC под PCIe не всем понравится, а вот покупка еще одного SSD, аналогичного имеющемуся, может оказаться куда менее затратным и более простым мероприятием. Да и никакой пугающей новизны в данном случае нет, о проблемах пропускной способности PCIe при использовании нескольких устройств можно не думать, да и вообще — подобный массив можно собирать на очень многих платформах, в то время как NVMe RAID без серьезных плясок с бубном создается только на самых «свежих», и то не на всех.

В общем, смысл вроде бы прослеживается. Но что получится на практике? Во всяком случае, интересно посмотреть — чем мы сегодня и займемся.
Методика и объекты тестирования

Методика подробно описана в отдельной статье, там же можно познакомиться с используемым аппаратным и программным обеспечением.

Основным рабочим телом нам послужит Silicon Power Velox V85 480 ГБ: уже пожилое устройство на базе контроллера Phison PS3110-S10 и 15-нанометровой MLC-памяти Toshiba. Второго в точности такого не нашлось, но такой же емкости и построенный на идентичной платформе — без проблем. Это еще один плюс идеи SATA RAID0: симметричность обеспечить очень легко.

Из прошлого материала мы взяли также результаты Intel SSD 600p и WD Black первого поколения по 512 ГБ — поодиночке и в массиве. Пусть массив получился бестолковым с практической точки зрения, но для сравнения он нам подойдет. Также возьмем Intel Optane SSD 800P 118 ГБ и два Optane SSD 800P в массиве RAID0, благо в свое время мы такой массив собирали. Три немножко разных массива RAID0 дадут нам в сумме немного больше информации о собственно RAID0 на современных платформах. И это важно, поскольку основная наша задача сегодня — все-таки исследовательская, а не практическая :)

Поскольку сегодняшнее тестирование достаточно специфично, мы не стали заносить результаты тестов в общую таблицу: они доступны в отдельном файле в формате Microsoft Excel. Так что желающие покопаться в цифрах (тем более, что не все они попадают на диаграммы) могут скачать его и удовлетворить любопытство.
Производительность в приложениях

Два симметричных массива работают чуть быстрее, чем накопители, из которых они построены — асимметричный наоборот. С другой стороны, разброс производительности здесь настолько не велик, чтобы об этом вообще стоило задумываться. Причина озвучена неоднократно — и самого медленного из испытуемых уже достаточно для того, чтобы производительность определялась не им.

Да и потенциальный выигрыш не так уж велик — даже когда он есть. Это для Optane 800p фактическое удвоение ширины интерфейса и степени чередования полезно, но в случае SATA и протокола AHCI (а другой тут неприменим) много уже не наработаешь. Даже Intel SSD 600p (один из самых медленных накопителей в своем классе) и то заметно быстрее в этом тесте, а попытка использовать его в паре с еще одним «неторопливым» SSD результат только уменьшает — но все равно не до уровня «увеличенного» SATA RAID0.

Предыдущая версия пакета, оперирующая более «легкими» нагрузками, более благосклонна к любым массивам. Однако не менее очевидно, что какой-то внятный прирост можно увидеть только на паре маленьких, но шустреньких «опташ», да и то — в синтетическом режиме. SATA RAID же медленнее одиночного (и медленного же) NVMe-накопителя. Такие дела.
Последовательные операции

Окончательно убеждаемся в том, что этой программе «сносит крышу» дополнительное кэширование силами драйвера при использовании RAID-массивов. Во всяком случае, на операциях чтения — запись-то выглядит правдоподобно. И показывает нам, что пропускную способность интерфейса действительно можно удвоить при помощи создания массива RAID0. Но сейчас этим уже заниматься не нужно (чаще всего), поскольку появилась уже возможность мигрировать на еще более быстрый интерфейс.
Случайный доступ

Как видим, все сценарии ведут себя по-разному — это тот случай, когда на производительность могут влиять любые факторы. Объединение накопителей в массив с чередованием — еще один дополнительный. Который может скорость как повысить (например, если при исходных данных немного «не хватает» пропускной способности интерфейса и/или степени внутреннего параллелизма), так и наоборот. В любом случае, «сменить класс» устройства этим способом не выйдет. Т. е., например, скорость чтения с единичной длиной очереди команд (что как раз и наиболее значимо на практике) зависит только от задержек самой памяти — и поэтому любые Optane здесь вне конкуренции. А никакой сменой протоколов или интерфейсов это не изменить. Тем более, объединением устройств в массив RAID0.
Работа с большими файлами

В принципе, это в первую очередь задача на интерфейс — а он в настоящее время может быть и куда более быстрым, нежели «дабл сата». В итоге прирост производительности в массиве-то «сверхлинейный», но на фоне других устройств (в т. ч. и медленных в своем классе) эффект просто теряется.

Очень многое зависит от памяти, так что SATA-накопитель на «быстрой» MLC может с легкостью обгонять PCIe на медленной TLC, а в массиве удвоить свою производительность. Но, опять же, на сегодняшний день это уже не имеет особого значения, поскольку быстрые NVMe-устройства уходят далеко за гигабайт в секунду и в одиночестве.

Аналогичный случай. Хотя и это «удобный сценарий» для массивов, но, фактически, они чем-то «помогают» лишь тем накопителям, производительность которых искусственно ограничена интерфейсом (не только SATA600 — у Optane 800p аналогичная проблема из-за всего двух линий PCIe). Но после внедрения PCIe 3.0 x4 в этот сегмент подобное случается крайне редко.
Рейтинги

Жизненное наблюдение: ранее к нам на тестирование регулярно привозили ноутбуки с RAID0 из пары SATA SSD, причем часто такие модели предназначались специально для тестовых лабораторий, а в розницу эти же модели, как правило, поступали с одиночным твердотельным накопителем либо с одним SSD и одним винчестером, а иногда и вовсе с одним только винчестером. После внедрения NVMe подобная практика прекратилась мгновенно, и причина хорошо видна на диаграммах: массив из пары SATA-накопителей способен побороться с одиночным «медленным» NVMe-устройством, но вот быстрый NVMe SSD в любых «попугаях» длиннее. Поэтому в случае современных платформ незачем и возиться. Владельцы же «старых» платформ (без поддержки NVMe) могут извлечь какую-то практическую пользу из SATA RAID0 и сейчас — но небольшую и не всегда.
Итого

На этом, как нам кажется, тему RAID-массивов в применении к массовым конфигурациям можно закрывать, благо мы рассмотрели уже почти все основные варианты. За кадром остались только связки из пары одинаковых топовых устройств (Optane SSD 800P все-таки на такое не совсем тянет), но и с ними тоже все уже ясно: где-то производительность увеличится, где-то — нет, но за пределы синтетики все эти отличия не выйдут. Во времена винчестеров, когда не хватало иногда даже последовательных скоростей, никаким способом хоть что-то ускорить пренебрегать было нельзя. Сейчас же есть более простые способы, иногда оказывающиеся и более дешевыми (можно сэкономить на платформе, да и цена твердотельных накопителей с ростом емкости увеличивается не линейно). Со всеми вытекающими.
