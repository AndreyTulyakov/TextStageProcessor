
Обзор сетевого накопителя Synology FlashStation FS1018
Оглавление

    Комплект поставки и внешний вид
    Конструкция и аппаратные характеристики
    Сетевая карта Synology E10G17-F2
    Установка и настройка
    Тестирование
    Заключение

Обычно массовые сетевые накопители позиционируются как устройства для хранения больших объемов информации без существенных требований к скорости доступа. Так что вполне логично, что большинство моделей предназначено для работы с традиционными жесткими дисками формата 3,5″, которые сегодня могут предложить емкости до 16 ТБ при относительно невысокой стоимости. При этом учитывая, что работа ведется преимущественно по гигабитной локальной сети, применение винчестеров обычно не ограничивает потоковые скорости чтения и записи.

Конечно, большинство производителей допускает установку в свои устройства и накопителей SSD. Они могут использоваться как кэш для томов на жестких дисках, для организации независимых томов или для тиринга. В некоторые сетевые накопители можно установить и накопители формата M.2 с интерфейсом NVMe. Однако на практике ощутить эффект от применения SSD обычно можно только в определенных сценариях. Такие распространенные применения как сетевой доступ к файлам, медиасервисы, загрузка файлов и резервное копирование практически ничего не выигрывают от работы с твердотельными накопителями. С учетом того, что по стоимости модели высокой емкости существенно проигрывают жестким дискам, а для их эффективного использования требуется сетевой накопитель на мощной платформе и быстрая сетевая инфраструктура, решения только для SSD встречаются редко. С другой стороны, мы видим рост востребованности решений All-Flash в сегменте высокопроизводительных систем хранения данных, поскольку уже ни у кого нет сомнений, что SSD здесь находятся вне конкуренции.

Компания Synology весной 2017 года представила свое первое устройство этого класса — FlashStation FS2017. Эта модель, выполненная в формфакторе 2U для установки в стойку, могла похвастаться восьмиядерным процессором Intel Xeon, возможностью установки 128 ГБ оперативной памяти, встроенными сетевыми контроллерами 10 Гбит/с, слотами для плат расширения. В основное устройство можно установить до 24 накопителей формата 2,5″. При необходимости расширения объема можно использовать до двух фирменных блоков расширения на 12 отсеков 3,5″ или 24 отсеков 2,5″. Далее была выпущена более мощная модель — FS3017, в которой применялось уже два процессора Xeon и производительность в IOPS на случайных операциях записи выросла с 90 000 до 200 000.

Одним из оригинальных решений для серии FlashStation является реализация типа отказоустойчивого массива RAID F1. Для твердотельных накопителей, которые имеют ограниченный ресурс флэш-памяти на перезапись, применение традиционных алгоритмов RAID1/5/6 с равномерным распределением нагрузки может привести к синхронному износу SSD, что потенциально является причиной выхода массива из строя. Решение основано на RAID5 с одной поправкой — один из накопителей получает более высокую нагрузку на запись блоков контрольных сумм. Этот же подход применяется и при перестроении массива в случае отказа одного из дисков — на роль нового «избранного» выбирается тот, что имеет максимальный износ.

Последние две новинки в серии — обновление старшей модели FS6400, получившее еще более мощную платформу, и настольный вариант флэш-хранилища FS1018, о котором и пойдет речь в этой статье.
Комплект поставки и внешний вид

Модель поставляется в картонной коробке с привычным для данного производителя оформлением. Коробка имеет ручку для удобства переноски, но учитывая размер и вес, пользоваться ей стоит осторожно.

В комплект поставки входят кабель питания, два сетевых патч-корда, два ключа для дисковых отсеков и краткая инструкция.

На сайте производителя представлены обновления прошивки, программное обеспечение для NAS и для клиентов, электронные версии документации, списки совместимости, документы по некоторым использованным технологиями, а также обширная база знаний. Причем подавляющее число документации есть и на русском языке.

Внешний вид напоминает модели DiskStation серий Plus на большое число отсеков. Габаритные размеры составляют около 28×23×17 сантиметров. Дополнительно не забываем про пространство для подключения кабелей и охлаждения. Корпус имеет крышку из металла, покрашенную черной матовой краской. Аналогично оформлена и задняя панель. А вот дно решили не красить.

Передняя панель традиционно выполнена из пластика. В верхней ее части мы видим два индикатора состояния (Status и Alert), кнопку включения питания со встроенным индикатором и четыре светодиода активности встроенных сетевых интерфейсов.

Далее идут расположенные в два столбца дисковые отсеки. Около них есть подписи с номерами, так что не придется угадывать, где какой диск установлен. Правда, подписи относительно мелкие и могут быть не очень хорошо видны.

Дисковые отсеки с поддержкой горячей замены имеют простые механические замки. Если вы потеряете комплектные ключи, не будет никаких проблем в использовании плоской отвертки или другого инструмента. Кроме того, на отсеках находятся индикаторы состояния каждого диска.

Для крепления SSD или HDD в рамках не потребуется никаких инструментов. На левой боковой стороне установлены фиксированные пластиковые штыри, а на правой предусмотрены специальные защелки. Так что установка или замена накопителя осуществляется буквально за несколько секунд.

В самом низу в правой части передней панели установлен порт USB 3.0. Причем его даже сложно заметить. Скорее всего, для работы с ним можно использовать только тонкие устройства или кабели.

Учитывая конструкцию дисковых отсеков, между которыми есть достаточно большие щели, именно этот вариант является основным для поступления воздуха в систему охлаждения. На левой боковой стенке корпуса находится выполненная в формате логотипа производителя дополнительная решетка.

На задней панели в центре расположен блок с двумя вентиляторами формата 92 мм. Существенным плюсом относительно недавнего обновления конструкции является использование здесь специальной съемной панели. Так что пользователю не составит труда при необходимости почистить или заменить вентиляторы, поскольку полная разборка корпуса для этих операций не потребуется.

Слева видна наклейка с серийным номером накопителя и MAC-адресами сетевых контроллеров. Под ней в углублении — вход кабеля питания (стандартный компьютерный С13/С14). Еще ниже — отверстие кенсингтонского замка.

По нижнему краю, где как раз установлена основная материнская плата, идут остальные порты: два фирменных разъема для подключения модулей расширения, четыре гигабитных сетевых порта с индикаторами скорости и активности, два порта USB 3.0. Между разъемами скрывается кнопка сброса.

Справа мы видим место для установки плат расширения. В данном сетевом накопителе для них применяется стандартный конструктив низкопрофильного формата с креплением задней планки на винт.

Опирается корпус на четыре крупные ножки с резиновыми вставками. Также на дне мы видим информационную наклейку, отсек для доступа к модулям оперативной памяти и закрытый заглушкой консольный порт.

Устройство имеет узнаваемый дизайн, который будет уместно смотреться и дома и в офисе, при условии, что вас устроит черный цвет. Конструкция надежная, практичная и удобная. Единственное замечание может быть если только к фронтальному порту USB. В плюсы занесем съемный блок вентиляторов и наличие отсека для замены модулей памяти.
Конструкция и аппаратные характеристики

Внутренняя конструкция сетевого накопителя использует знакомую и отработанную схему. Задняя панель, дно, корзина для накопителей, передняя панель, съемная верхняя крышка выполнены из 1-миллиметровых листов металла.

Дополнительно внутри есть «второе дно», под которым находится основная печатная плата, а сверху на нем закреплена корзина. Разбирать все это полностью — очень трудоемкая задача. Но, скорее всего, никому это не потребуется, учитывая возможность легкого доступа к вентиляторам и модулям оперативной памяти. Кроме того, подобные действия могут нарушить условия гарантийного обслуживания.

По сути, доступ внутрь корпуса пользователю необходим только для установки платы расширения. Место для нее предусмотрено в левой части корпуса. Причем его достаточно много — длина карты может достигать 21 см, по высоте ограничений можно считать нет, по толщине — примерно полтора слота. Может показаться, что штатная система охлаждения сетевого накопителя не затрагивает этот слот, но на самом деле есть решетка на левой стенке и щели на дне корпуса, так что проблем при установке карт с высоким тепловыделением быть не должно.

Симметрично с другой стороны дисковой корзины установлен блок питания производства Delta Electronics на 240 Вт. Формат у него стандартный для компактных корпусов, однако набор разъемов отличается от версии для ПК — два оригинальных кабеля идут на бекплейн для дисков. Заметим, что в блоке питания присутствует собственный компактный вентилятор. Во время тестирования он не оказывал существенного влияния на производимый шум.

Сетевой накопитель работает на платформе Intel, но в отличие от старших собратьев, в нем применяется чип Intel Pentium D1508. Данная SoC выполнена в формате BGA и припаяна к плате, так что замена невозможна. Микросхема имеет два вычислительных ядра, способных выполнять по два потока каждый, которые работают на базовой частоте 2,2 ГГц. Также в чипе есть контроллеры шины PCIe, USB, SATA, сетевой адаптер и другие блоки, не все из которых используются в данном сетевом накопителе. TDP составляет 25 Вт и чип охлаждается через радиатор без отдельного вентилятора. Для установки оперативной памяти предусмотрено два слота SO-DIMM DDR4. Штатно предустановлен один модуль на 8 ГБ. Максимально можно установить 32 ГБ (два модуля по 16 ГБ).

Четыре сетевых контроллера сетевого накопителя обслуживаются чипами Intel i210.

Также на плате можно найти две микросхемы Marvell 88SE9235, которые отвечают за подключение внешних блоков расширения.

А вот собственные дисковые отсеки в количестве двенадцати штук подключены через контроллер Marvell 88SE1475, работающий на шине PCIe 3.0, что позволяет исключить узкие места при работе с высокопроизводительными SSD. На нем даже установлен небольшой радиатор, а сам чип разместили на бекплейне.

Система охлаждения включает в себя два вентилятора Y.S.Tech FD129225EB-N с трехпроводным подключением. Предусмотрен контроль за их работой и автоматическая регулировка оборотов.

Уровень шума можно оценить как низкий, что важно для данного формата, поскольку предполагается эксплуатация в обычных офисных или домашних условиях, а не в выделенном помещении. При том, что SSD являются абсолютно бесшумными, именно вентиляторы определяют уровень комфорта.

В официальном списке совместимости представлено большое количество SSD от многих известных производителей. При этом максимальный заявленный объем (на момент подготовки статьи) — 7,68 ТБ для модели Micron 5210 ION, что дает около 90 ТБ максимум (без отказоустойчивости). Учитывая, что в рассматриваемой модели используется достаточно быстрый (для этого класса устройств) процессор, логично выглядит реализация поддержки подключения до двух внешних блоков расширения DX1215. В каждый из них можно установить 12 SATA накопителей форматов 3,5″ или 2,5″, включая жесткие диски объемом 16 ТБ. Так что при необходимости максимальный объем томов можно будет существенно увеличить, в том числе и использованием относительно недорогих традиционных жестких дисков. Кроме того, благодаря наличию слота расширения, в устройстве можно использовать также накопители формата M.2 и сетевые адаптеры с поддержкой скоростей до 40 Гбит/с включительно.

Без тестов сложно оценить, насколько удачно производитель выбрал платформу для своего нового хранилища на базе флэш-памяти. С одной стороны, может показаться, что Intel Pentium слишком слабый для эффективного использования двенадцати быстрых накопителей. С другой стороны мы помним, что для устройств на базе традиционных жестких дисков успешно используются SoC серий Intel Atom и Intel Celeron. Заметим только, что в сравнении с Intel Xeon D-1541 из FS2017, используемый в рассматриваемом устройстве Intel Pentium D1508 имеет в четыре раза меньше ядер, потоков и кэш-памяти, а также меньшую скорость работы с оперативной памятью. А вот по возможностям внешних коммуникаций не отличается — оба чипа имеют 32 линии PCIe 3.0. Ну и конечно он существенно дешевле и имеет потребление в два раза меньше. Скорее всего, в синтетических тестах мы увидим хорошие показатели производительности, но в реальной работе устройству будет сложно справляться с большим числом одновременных задач.

Тестирование устройства проводилось с прошивкой DSM 6.2.2-24922.
Сетевая карта Synology E10G17-F2

Дополнительно с сетевым накопителем мы использовали в тестировании фирменную сетевую карту E10G17-F2. Она поставляется в небольшой картонной коробке. В комплект входит дополнительная планка для установки в низкопрофильные корпуса.

Продукт основан на чипе Mellanox семейства ConnectX-3 Pro MT27520, работает на шине PCIe 3.0 x8 и обеспечивает два сетевых порта 10 Гбит/с с подключением через трансиверы SFP+ или кабели DAC.
Установка и настройка

Действия по инсталляции встроенного программного обеспечения не отличаются от других моделей данного производителя — устанавливаем хотя бы один накопитель, подключаем сеть, включаем питание, с использованием веб-сервиса или фирменной утилиты находим новое устройство в сети и устанавливаем на него прошивку прямо из сети Интернет или заранее загруженного файла. Для дальнейшего управления сетевым накопителем применяется веб-интерфейс. Он переведен на несколько языков, включая русский, поддерживает https и двухфакторную аутентификацию с использованием мобильного устройства. Для новичков предусмотрен минимальный мастер настройки. В случае появления вопросов, можно обратиться к многочисленным статьям в базе знаний или видеороликам на сайте производителя. Обратим также внимание на наличие службы поддержки в локальном представительстве компании. Некоторые сервисы, в частности QuickConnect и обращения в техподдержку, привязаны к учетной записи на портале Synology. Для ее создания потребуется адрес электронной почты.

Дизайн интерфейса DSM достаточно удобный — предусмотрены меню, блок уведомлений, многооконная работа, встроенная справочная система и форма обращения в техподдержку. К отзывчивости на современных моделях замечаний нет. Кстати, версия 6.2.2 доступна и для младших устройств линейки 2013 года, хотя на них она, конечно менее «резвая».

Решение обеспечивает гибкую конфигурацию дисковых томов (в том числе, назначение Hot Spare), операции миграции и расширения, а также позволяет контролировать состояние накопителей, включая регулярные проверки SMART. Есть настройка приоритета фоновых операций, расписание проверки четности для соответствующих пулов, ручной запуск дефрагментации на томах, встроенный тест производительности дисков.

Отдельный пункт меню предназначен для настройки iSCSI целей и LUN.

В прошивку также входит модуль «Мониторинг ресурсов», который позволяет оперативно контролировать нагрузку на устройство. В частности в нем отображаются общие и подробные графики использования ключевых ресурсов (процессор, память, диски, сеть), диспетчер задач, подключенные пользователи. Администратор может создать свои правила для отправки уведомлений при превышении параметрами заданных порогов. Причем кроме общесистемных можно поставить условия и для отдельных приложений, томов или LUN. Упомянем здесь поддержку протокола SNMP, что позволяет удаленно контролировать состояние сервера. Компания предоставляет для загрузки собственный MIB, в котором дополнительно представлены поля со статусом дисков и томов, температурами и другой информацией.

Также штатно присутствуют удобный файловый менеджер File Station со множеством дополнительных функций, модуль для настройки удаленного доступа к сетевому накопителю, программа для работы с журналами событий, сервис поиска (по именам, дате создания и по содержимому/метаданным для некоторых типов документов).

Основные настройки сетевого накопителя собраны в «Панели управления». Всего в полной ее версии есть более двух десятков пунктов. Организация достаточно удобная и логичная. Найти наиболее востребованные опции будет несложно. В случае необходимости можно воспользоваться встроенным поиском.

Решение поддерживает все основные протоколы сетевого доступа, включая SMB, AFP, NFS и FTP. Для протоколов предусмотрены дополнительные параметры, такие как версии для SMB и NFS, порты и другие опции для FTP.

Для ограничения доступа применяется стандартный механизм общих папок и прав пользователей. Поддерживаются группы, интеграция в Windows AD и LDAP, установка квот, ограничение скоростей для разных протоколов.

Очень много настроек и в разделе «Подключение». Встроенные сетевые интерфейсы можно объединять в группы, есть клиенты VPN, ограничения скоростей по протоколам, статическая маршрутизация, сервер DHCP, сервис удаленной загрузке PXE, клиент DDNS, автоматическая настройка проброса портов на роутере по базе совместимых моделей или через UPnP. Фирменный сервис QuickConnect существенно упрощает реализацию удаленного доступа к сетевому накопителю как из браузера, так и из мобильных утилит.

Учитывая современные требования, много внимания производитель уделяет безопасности. Сервер может работать по защищенным протоколам с SSL, использовать официальные сертификаты (в том числе, автоматически получаемые от сервиса Let’s Encrypt), имеет межсетевой экран с программируемыми пользователем профилями и правилами, блокирует попытки подбора пароля, реализует дополнительные меры защиты доступа. Здесь же стоит упомянуть функцию автоматической установки обновлений DSM, хотя на практике скорее она будет работать в режиме уведомлений о наличии новой версии, поскольку установка обычно связана с перезагрузкой сервера.

Встроенные средства отправки уведомлений работают с электронной почтой, SMS (при использовании внешнего сервиса), мобильными устройствами. При этом можно гибко настроить параметры сообщений, а вот получателей для email может быть не более двух.

Не забыли и про региональные настройки (в частности дата/время и язык) и возможности изменения внешнего вида окна входа и темы интерфейса. Хотя конечно подобные функции все-таки второстепенны.

В некоторых случаях будет удобно воспользоваться встроенным планировщиком задач. Причем в нем кроме предусмотренных производителем (например, очистка корзины, запуск тестов SMART, остановка и запуск служб) можно указать и пользовательский скрипт.

На странице «Оборудование и питание» осуществляется настройка подключения к ИБП (USB, SNMP или с другого NAS), установка расписания работы (мало востребовано для бизнес-применений), выбор режима работы вентилятора, установка яркости светодиодных индикаторов, выбор событий для звуковых уведомлений, включение WOL на сетевых интерфейсах.

Отметим, что в начале сентября на своей ежегодной конференции компания анонсировала выпуск в четвертом квартале этого года версии DSM 7.0. Ключевыми направлениями улучшений производитель называет упрощение и ускорение управления. Для системных администраторов с высоконагруженными устройствами будет интересны новые средства мониторинга ключевых параметров производительности и облачный доступ к ним. Домашних пользователей ждет новая программа для организации фотобиблиотеки. Также внимание было уделено более плотному взаимодействию с облачными сервисами, в частности, Synology C2.

Существенно расширить список решаемых задач можно установкой дополнительных пакетов из официального каталога. На момент подготовки статьи в нем насчитывалось 58 программ Synology и еще 73 сторонних производителей. В их числе сервисы резервного копирования, доступа к облачным ресурсам, программы синхронизации, медиасервисы, система видеонаблюдения, веб-сервисы, офисные пакеты и сервисы, языки программирования и средства разработки. Полный список можно посмотреть на сайте компании.

Также упомянем наличие удобных утилит для мобильных платформ, позволяющих получить доступ к файлам, медиаконтенту и сервисам.
Тестирование

Для тестирования сетевого накопителя в него было установлено четыре SSD Kingston DC500M объемом по 1,92 ТБ (SEDC500M1920G). Производитель позиционирует данную модель на базе 3D TLC NAND в корпоративный сегмент для работы со смешанной нагрузкой и особенно обращает внимание на ее возможность обеспечить стабильную предсказуемую производительность. Да, в рассматриваемом сетевом накопителе двенадцать отсеков, так что тест только с четырьмя накопителями, возможно, не сможет раскрыть все ее возможности. С другой стороны, здесь все-таки установлен процессор среднего уровня, да и к устройствам настольного формата предъявляются не такие требования, как к стоечным моделям с большим количеством отсеков. Тестировались конфигурации томов из одного SSD, а также массивы RAID1 из двух SSD, RAID5/RAID F1/RAID0 из четырех SSD. При создании тома использовалась файловая система BTRFS, а для общей папки включалась опция контроля целостности с применением контрольных сумм. Как и в других материалах по сетевым накопителям, основным инструментом оценки производительности выступает Intel NASPT с шаблонами для работы с файлами больших объемов. На клиенте при этом используется ОС Windows 10.

Понятно, что штатное сетевое подключение по локальной сети 1 Гбит/с для сетевого накопителя даже с одним SSD явно будет заметно ограничивать максимальные скорости последовательных операций. Но для сравнения и этот тест, конечно, стоит провести.

Практически во всех конфигурациях и шаблонах максимальные скорости составили более 100 МБ/с и действительно ограничены локальной сетью. Меньшие результаты мы видим только при случайном доступе для записи (50-60 МБ/с) и для смешанной нагрузке чтения и записи (70-80 МБ/с). Напомним, что для сходных по платформе сетевых накопителей с жесткими дисками в этих тестах обычно мы видим 20-30 МБ/с для отказоустойчивых массивов.

Интереснее посмотреть на работу NAS с более быстрыми сетевыми подключениями. О схеме с объединением портов мы уже рассказывали ранее. Напомним, что она позволяет увеличить общую скорость обмена данными при одновременной работе с несколькими клиентами, но не поможет ускорить работу, если клиент только один. Так что в данной статье для соединения 10 Гбит/с мы использовали адаптер E10G17-F2 в FS1018 и Intel X520-DA2 на клиенте. Подключение осуществлялось напрямую кабелем DAC. Из опций оптимизации дополнительно включались Jumbo Frames. Посмотрим, на что способна эта конфигурация.

Максимальные достигнутые в тестах скорости последовательных операций составили около 500 МБ/с на чтение и 700 МБ/с на запись. Отдельно нужно отметить преимущество RAID F1 перед RADI5 на записи. Производительность при случайном доступе тоже впечатляет — почти 300 МБ/с на чтении и около 200 МБ/с на записи. При этом отличия между типами массивов обусловлены скорее числом накопителей в них. В частности массив с чередованием не дает заметных преимуществ по скорости по сравнению с отказоустойчивыми конфигурациями.

Посмотрим теперь на реализацию фирменной технологии RAID F1. Про производительность работы этого типа массива мы уже писали выше — для сетевого подключения 1 Гбит/с она минимально отличается от RAID5, а при работе на 10 Гбит/с этот вариант даже заметно быстрее на операциях случайной и последовательной записи.

Для начала оценим скорость создания массивов RAID F1 и RAID5 из четырех использованных накопителей. Заметим, что DSM позволяет пользователю начать работать с новым массивом сразу после его инициализации и осуществляет синхронизацию в фоне. На эту операцию при отсутствии какой-либо другой нагрузки на устройство потребовалось немногим более часа: 1:16 для RAID F1 и 1:03 для RAID5. Учитывая, что это действие требуется нечасто, можно считать разницу несущественной.

Сравним теперь нагрузку на чтение и запись на каждый диск в этих массивах. Помогут нам в этом атрибуты 241 и 242 из SMART. По информации производителя SSD эти счетчики отражают общее число записанных и прочитанных гигабайт, однако в корректности указания единиц измерения есть сомнения. С другой стороны, нас интересуют не абсолютные значения, а сравнение нагрузки на разные накопители. Процесс инициализации массива не показывает существенных отличий (в таблице приводятся изменения «сырых» значений атрибутов за время проведения операции):
 	RAID5 запись / чтение	RAID F1 запись / чтение
SSD 1	75 / 1	75 / 0
SSD 2	75 / 0	75 / 0
SSD 3	74 / 0	74 / 0
SSD 4	75 / 0	74 / 0

Проведем теперь цикл нашего тестирования. Общий объем данных в нем составляет 320 ГБ. А по суммарной нагрузке по всем тестам (включая подготовку) преимущество у записи.
 	RAID5 запись / чтение	RAID F1 запись / чтение
SSD 1	59 / 76	69 / 93
SSD 2	59 / 75	61 / 104
SSD 3	59 / 75	62 / 104
SSD 4	59 / 75	62 / 104

Для массива RAID5 нагрузка равномерно распределена по всем четырем SSD. А на RAID F1 картина другая — первый SSD получил больше запросов на запись и меньше на чтение, чем другие диски в массиве. Интересна и разница между массивами по абсолютным значениям — RAID F1 имеет заметно более высокую нагрузку на чтение.

В целом можно говорить о том, что реализация RAID F1 действительно может быть интересна с точки зрения обеспечения неравномерного износа SSD для исключения их одновременного выхода из строя. С другой стороны, данная технология обеспечивает отказоустойчивость только к выходу из строя одного диска, что нехорошо для массивов большого объема, а также является проприетарной, что затруднит восстановление данных в случае серьезных проблем. Конечно, на оба вопроса есть универсальный ответ — резервное копирование, но все-таки, на наш взгляд, RAID F1 не может претендовать на широкое распространение сегодня.

Использование сетевых накопителей с SSD может быть интересно для работы с томами iSCSI в системах виртуализации, где важно иметь быстрый доступ в блочном режиме. В текущих версиях DSM iSCSI LUN создаются на уже существующих пулах дисков. При этом пользователю доступно много настроек, включая тип тома (thick или thin), выбор максимального размера блока передачи данных, включение CRC и CHAP, привязка к интерфейсам, установка прав и другие. LUN поддерживают расширенные функции и API, актуальные для систем виртуализации. Для томов формата thin предусмотрена работа со снимками и дефрагментация. Тестирование мы проводили в программе IOMeter с томами thick и thin объемом по 1 ТБ на пуле RAID F1 с подключением по локальной сети 10 Гбит/с. Набор шаблонов включал в себя последовательные и случайные операции с блоками разных размеров с глубиной очереди 32.

На последовательных операциях оба тома ведут себя сходным образом: на чтении максимум немногим более 700 МБ/с достигается при блоке в 512 КБ, при записи с размером блока от 64 КБ выходим на стабильные показатели порядка 750 МБ.

При случайном чтении отличия также найти непросто. А вот на операциях записи том thin ведет себя существенно лучше, чем thick. Если использовать не MB/s, а более привычные для случайного доступа IOPS, то для блока 4K том thick показывает 45000 на чтение и 4000 на запись, тогда как том thin — 46000 на чтение и 13000 на запись. Так что получается, что во всех случаях лучше использовать именно второй вариант. Однако это потребует более точного прогнозирования объемов и контроля свободного пространства.

Накопители на базе фл'ш-памяти, благодаря своим скоростным характеристика, интересны при реализации систем виртуализации. Рассмотрим этот вариант использования. Для этого на тот же клиентский ПК, который, конечно не тянет на «настоящий сервер», но для нашей цели вполне подойдет, была установлена система виртуализации Proxmox VE. В ней были настроены, кроме обычного варианта на штатном накопителе, хранилища на FlashStation FS1018 в виде тома LVM поверх thin LUN iSCSI и общей папки NFS. Для подключения здесь тоже использовалось соединение 10 Гбит/с. Далее мы создали виртуальную машину с Debian 10, так что образ ее системного диска находился на самом сервере, а второй, тестовый, объемом в 32 ГБ размещался на FS1018 (в случае NFS — в формате raw). В роли тестового инструмента выступал все тот же IOMeter.

Как мы видим, работа по двум протоколам существенно отличается с точки зрения скорости. Так что при выборе конфигурации для системы хранения образов дисков виртуальных машин стоит протестировать и сравнить разные варианты. Причем в данном случае мы использовали настройки по умолчанию, как для самой виртуальной машины, так и для Proxmox VE. А там тоже есть много всего интересного.

Еще более существенную разницу показывают шаблоны случайного доступа, если речь о работе с блоками большого размера. При этом в обычно используемом для оценки варианте с блоком 4К результаты следующие: для iSCSI чтение/запись около 41000/30000 IOPS, для NFS — около 46000/32000 IOPS.

Для сравнения приведем полученные в аналогичных условиях (но с другим сервером виртуализации и медным соединением 10 Гбит/с) графики для решения более высокого уровня, работающего с HDD (Synology RS18017xs+ и том RAID6 из 12 жестких дисков корпоративного уровня).

На последовательных операциях все в целом неплохо и производительность достаточно высока.

Но вот случайные операции явно являются очень сложной нагрузкой для отказоустойчивых массивов из HDD. Для размера блока в 4К в этом случае у нас получается 4600/9600 IOPS для чтения/записи с iSCSI и 6000/11500 IOPS для чтения/записи с NFS. Конечно, никто не спорит с тем, что твердотельные накопители обеспечивают существенно более высокий уровень производительности в таких условиях. Но иногда полезно знать и конкретные цифры для ориентира.

При рассмотрении результатов тестирования температурного режима и энергопотребления, нужно учитывать, что в сетевой накопитель было установлено только четыре накопителя (в конфигурации RAID F1) и еще восемь отсеков были свободны. Проверялись режимы бездействия (значения приводятся после получаса простоя) и работы (указаны максимальные значения для всего цикла тестирования). Для твердотельных накопителей режим сна в данном случае не актуален. Температура окружающей среды составляла около 22 градусов. Использовались отсеки 1, 3, 5 и 7.

Система охлаждения без проблем справляется с обеспечением комфортной температуры как для дисков, так и для процессора при сохранении невысокого уровня шума. При этом тест проводился в режиме управления скоростью вентиляторов «Тихий». Заметим, однако, что в определенных сценариях нагрузка на процессор может быть существенно выше и он нагревается заметно быстрее. В результате при достижении порога около 68 градусов скорость вентилятора возрастает, так что он уже будет заметен в тихой офисной или домашней обстановке.

Современные быстрые SSD больших объемов могут иметь и достаточно высокое энергопотребление. В частности для использованных в статье накопителей заявлено до 7,5 Вт в режиме записи. Для сравнения — винчестеры WD Red 2 TB, которые мы обычно применяем в тестах NAS, имеют средние показатели во время работы немногим более 4 Вт.

Учитывая вышесказанное, в реальности при заполнении всех отсеков в сетевом накопителе мы наверняка выйдем на существенно более высокий уровень («цена работы» одного SSD по приведенным цифрам — около 6,7 Вт). Заметим также, что и сама платформа в бездействии потребляет почти в два раза больше, чем ранее протестированные модели с Intel Celeron. С другой стороны, по сравнению с традиционными серверами показанные значения невелики.
Заключение

Стоимость Synology FlashStation FS1018 составляла 130-140 тысяч рублей на момент подготовки материала. Данная модель имеет 12 отсеков для SSD формата 2,5″, достаточно мощную для своего класса платформу, возможности увеличения объема оперативной памяти и установки платы расширения, а также поддерживает подключение внешних блоков для накопителей формата 3,5″. При этом в базовой конфигурации раскрыть потенциал даже одного SSD будет непросто, не говоря уже о массиве. Конечно, здесь есть слот для карт расширения, так что можно установить карту Ethernet 10 Гбит/с или даже более быструю, но это уже дополнительные затраты. Кроме того, на наш взгляд, использование SoC Intel Pentium для обслуживания дюжины SSD выглядит немного необычно. Плюс этот чип сложно назвать хорошо подходящим под задачи виртуализации (даже если добавить оперативной памяти) или ресурсоемкие приложения.

Учитывая, что SATA SSD можно без проблем установить и в модели других серий данного производителя, в том числе с отсеками для накопителей формата 3,5″, то конкурентами среди «настольных» моделей могут выступать DS1819+ (в два раза дешевле, 8 отсеков, платформа Intel Atom), DS3018xs (немного дешевле, 6 отсеков, та же платформа), DS2419+ (примерно та же стоимость, 12 отсеков, Intel Atom), DS3617xs (в полтора раза дороже, 12 отсеков, процессор Intel Xeon). Правда, поддержка RAID F1 в них отсутствует. Ну и нельзя здесь не вспомнить про DiskStation DS620slim — модель на 6 отсеков формата 2,5″ на платформе Intel Celeron с парой гигабитных сетевых портов и без слота для карт расширения, зато в три раза дешевле. На первый взгляд, в такой плотной группе Synology FS1018 будет очень непросто найти своего целевого покупателя.

Тестирование показало, что FlashStation FS1018 в определенном смысле уникальный продукт. При относительно небольших габаритных размерах в него можно установить двенадцать SSD-накопителей и получить тихое быстрое хранилище высокой емкости. Интересно, что аналогичный по размерам вариант на шесть отсеков 3,5″ проигрывает герою статьи более чем в два раза по емкости отказоустойчивого тома RAID6. Говоря, что хранилище быстрое, мы подразумеваем не столько скорость на задачах сетевого доступа к медиаконтенту больших объемов или резервного копирования, сколько производительность, необходимую для приложений, требовательных к быстрому отклику. Например, это могут быть базы данных, тома iSCSI для серверов виртуализации, каталоги фотографий, почтовые базы, репозитории программного обеспечения. Еще одной особенностью продукта является «настольный» формат модели, который явно намекает на использование в компаниях и офисах без выделенного помещения или стойки под серверное оборудование. Хотя не стоит забывать, что одним из преимуществ сетевых накопителей является как раз возможность эффективной работы при подключении в любую точку локальной сети. Что же касается стоимости, то старшие модели FlashStation, в частности FS2017 и тем более FS6400, существенно отличаются по аппаратной конфигурации и производительности, и на их фоне цена FS1018 уже не так пугает.

Synology FlashStation FS1018 сложно назвать универсальным сетевым накопителем для широкого круга пользователей. Это решение будет интересно тем, кому требуется компактная модель традиционного формата с высокими показателями емкости и скорости, а бюджет существенной роли не играет. При этом наличие опции расширения оперативной памяти и дополнительного слота PCIe позволит устройству справиться с возможным ростом нагрузки в течение срока эксплуатации.

В заключение предлагаем посмотреть наш видеообзор сетевого накопителя Synology FlashStation FS1018