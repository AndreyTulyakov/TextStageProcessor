
Обзор и тестирование SSD для систем видеонаблюдения Hikvision V100 и V210 и бюджетного Hikvision С100
Оглавление

    HikVision C100 960 ГБ
    HikVision V100 1 ТБ
    HikVision V210 1 ТБ
    Тестирование
    Методика тестирования
    Образцы для сравнения
    Производительность в приложениях
    Последовательные операции
    Случайный доступ
    Работа с большими файлами
    Рейтинги
    Итого

Методика тестирования накопителей образца 2018 года

По мере снижения стоимости флэш-памяти твердотельные накопители (в основной массе на данный момент ее и использующие) начинают осваивать все новые ниши — зачастую непривычные с точки зрения житейской логики. За последние 10 лет даже пользователи ПК привыкли к тому, что SSD является хорошим «системным» накопителем, то есть местом хранения операционной системы и приложений — но не данных, которые по-прежнему оптимальнее держать на привычных винчестерах. Винчестеры в данном контексте хороши ровно одним: они дешевле, так что за те же деньги можно позволить себе бо́льшую емкость (или можно сэкономить при равной емкости), а скорости... зачастую хватает. Первые тревожные звоночки, впрочем, звучат: для некоторых задач скорости уже не хватает. А в часть компьютеров винчестеры уже просто «не помещаются» — если не все, то, по крайней мере, наиболее емкие и выгодные. Но пока еще это не стало общей практикой.

Однако если отвлечься от персонального применения и посмотреть на рынок ширше, становится очевидным, что количество подобных «проблем» только нарастает. В итоге на серверном рынке концепция «all flash» постепенно становится доминирующей — а хранилища для «холодных» данных на базе винчестеров превращаются как раз в выделенные системы (как оптические или ленточные библиотеки). Естественно, это не может не сказываться в областях, лежащих на границе «корпоративного» и «персонального» сегментов — NAS, системах видеонаблюдения и т. п. В частности, летом прошлого года мы знакомились с первой линейкой SSD, позиционируемой как решение для NAS. Сегодня же познакомимся с твердотельными дисками для систем видеонаблюдения.

В отличие от накопителей на жестких дисках, где специализация не меняет радикально характеристики накопителей (поскольку их не изменишь — все упирается в задержки самой механики), «тюнинг» твердотельных накопителей не только лишь возможен, но и достаточно прост. По большому счету, даже небольшие изменения прошивки могут существенно изменить поведение устройства. Именно это мы сегодня и проиллюстрируем практическими примерами.
Hikvision C100 960 ГБ

Этот накопитель компания позиционирует для просто компьютеров. C100 — бюджетное семейство, и достаточно популярное, но до последнего времени упор в нем делался на младшие модели с емкостью 240 или даже 120 ГБ. В официальной документации на сайте Hikvision линейка до сих пор так и кончается моделью на 480 ГБ — хотя в продаже-то уже свободно лежат и 960, и 1920 ГБ. В принципе, как раз при низкой емкости флэш-памяти наиболее заметна (и даже в какой-то степени полезна) экономия на контроллере и DRAM, так что такие модели традиционно доминировали в сегменте бюджетных SSD. Но по мере снижения цен на флэш-память они начинают вторгаться в святая святых энтузиастов, иногда повергая их в шок. Действительно, было время, когда терабайтников на рынке вообще не водилось (да и спроса на них не было), потом они появились среди дорогих элитных моделей... А сейчас, приобретая SSD на 1 ТБ, надо внимательно смотреть на характеристики и делать правильный выбор.

Важность этого хорошо видна по графику последовательной записи на весь объем. В принципе, эта картина абсолютно типична для устройства на базе безбуферного контроллера Silicon Motion SM2258XT и 64-слойной памяти 3D TLC NAND Intel с кристаллами по 512 Гбит. Точнее, для используемой стратегии SLC-кэширования — но она во всех прошивках одна единственная: все данные «проходят» через SLC-кэш, емкость которого может достигать трети свободного места.

Для системного накопителя — нормальный подход. Интенсивных операций записи здесь не бывает, так что можно «уплотнять» данные в моменты простоя. А то и вовсе не спешить это делать, поскольку ОС и ПО в процессе работы создают множество временных файлов, которые потом один-два раза читаются и просто удаляются. Так что и нечего им вообще за пределы кэша выходить. И если у нас устройство малой емкости, то «однобитный» режим — вообще единственный способ хоть как-то его подстегнуть в работе. Даже при чтении данных. Поэтому SM2258XT и популярен в устройствах базового уровня.

Но вот использовать такой SSD во внешнем накопителе или, тем более, в системах видеонаблюдения не стоит. Специфика последних: пишем данные постоянно, причем без всяких выкрутасов, просто потоком или несколькими потоками. Забиваем все устройство, удаляем самые старые файлы — и по новой. Что получается, когда эта логика встречается с политикой SLC-кэширования? А ничего хорошего! Записали на терабайтник 320 ГБ в быстром режиме — исчерпали весь запас свободных блоков. Значит, уже после записи трети объема изначально пустого накопителя нам придется стирать его весь — и записывать эти 320 ГБ второй раз. Пока мы будем это делать, «придет» еще немало данных, которые тоже будут записываться по два раза. В общем, при самом хорошем раскладе запись 1 ТБ превращается на деле в запись 2 ТБ и стирание (даже при изначально пустом накопителе) тех же 2 ТБ. Соответственно, не стоит удивляться тому, что на этот процесс уходит два с половиной часа и больше «ресурса», чем можно было бы предположить, а итоговая средняя скорость составляет лишь ≈100 МБ/с. В принципе, скорость не такая уж плохая, если сравнивать с жесткими дисками, которые при работе в несколько потоков умеют проседать и ниже, но все-таки подобное решение обойдется намного дороже при отсутствии заметного выигрыша. Да и вести себя система будет нестабильно, что даже хуже, чем просто медленно.

Ну а для «просто ПК», повторимся, такие накопители приемлемы. Главное их достоинство — низкие цены: тот же C100 в московской рознице успешно конкурирует с устройствами аналогичной емкости, но на QLC-памяти. Впрочем, конкуренция по дешевизне мало что говорит о сравнении по скорости, с которой бывает всякое, и вообще — все бюджетные устройства одним миром мазаны, благо компоненты в них чаще всего одинаковые или очень близкие, да и гарантийные условия не отличаются. Hikvision дает на С100 типовые три года гарантии с ограничением «пробега» в 40 ТБ полной записи на каждые 120 ГБ емкости, то есть для нашего героя набираются вполне весомые 320 ТБ, что нормально. Тем более, что интенсивные операции записи ему вообще противопоказаны, и это следует учитывать до покупки, а не после.
Hikvision V100 1 ТБ

Самое обидное в том, что при таком количестве такой памяти слишком уж «выдрючиваться» с SLC-кэшированием вообще не требуется: она и сама по себе умеет быстро читаться и писаться. Но ХТ-линейка контроллеров Silicon Motion не выдрючиваться не обучена. Вот «полноценные» контроллеры этого производителя имеют разные варианты прошивок, но стоят подороже, да и DRAM еще нужно добавить... Казалось бы, нужно — но нет. На деле пригодный для потоковой записи твердотельный накопитель не обязательно должен быть дорогим.

Совсем другое дело! На тот же терабайт уходит уже всего 50 минут, т. е. скорость стабильно держится выше 300 МБ/с. И вот такой накопитель смысл уже имеет: он гарантированно быстрее жестких дисков. Да, дороже — но быстрее. А если писать данные не в один поток, а в несколько — то гораздо быстрее.

Как Hikvision это удалось? На деле в V100 используется точно такая же 64-слойная память 3D TLC NAND Intel с кристаллами по 512 Гбит и в тех же количествах. А контроллер — как бы не более дешевый: Maxio MAS0902A бывшего подразделения JMicron, выделенного пару лет назад в отдельную компанию. Мы с ним уже сталкивались в бюджетном окружении, и тогда это четырехканальное одноядерное DRAM-less чудо хороших воспоминаний не оставило. Но, судя по всему, в отличие от Silicon Motion, Maxiotek готов делать для заказчиков разные прошивки — с разными стратегиями кэширования. Цена же все равно остается относительно невысокой. Гарантия, естественно, трехлетняя, но TBW практически удвоился: 600 ТБ для терабайтника (и пропорционально для других емкостей). И действительно: раз от логики «один пишем — два в уме» удалось отказаться, то операции записи для V100 менее противопоказаны как по скорости, так и по влиянию на время жизни.
Hikvision V210 1 ТБ

V210 — существенно более дорогой продукт, нежели V100 или, тем более, C100. Предназначен он для «серьезных сфер», так что даже красивой розничной упаковки не имеет. Зато (в отличие от розничных моделей) производитель не поскупился на аппаратную защиту от сбоев питания (PLP) в виде танталовых конденсаторов. Казалось бы, здесь она не нужна: поскольку DRAM все равно нет (внутри тот же MAS0902A, не поддерживающий использование DRAM), то и спасать нечего, но, по-видимому, у производителя на этот счет другое мнение. Впрочем, очень может быть, что такая защита добавлена просто для солидности и придания покупателю уверенности в завтрашнем дне. Корпус тоже поменялся в соответствующем направлении: теперь половина его стальная, так что он весит 150 г — это больше, чем у винчестеров в том же форм-факторе. Придает уверенности и срок гарантии, который увеличен до пяти лет, а «разрешенный» полный объем записи — до 800 ТБ (для терабайтного накопителя). Сравните это с 600 ТБ у V100 или всего 320 ТБ у C100 — и все станет ясно.

Что забавно, скорость записи здесь ниже, чем у младшей модели, хотя и остается стабильной. Причина — другая флэш-память и совсем другая прошивка (у них даже названия не похожи: 0100EK30 и T181031 у V210/V100 соответственно). Память — 64-слойная BiCS3 3D TLC NAND SanDisk с кристаллами по 256 Гбит. Как видим, уменьшение емкости кристалла скорость при таком объеме не повысило — контроллер все равно четырехканальный, так что ему это не нужно. С другой стороны, в модификациях меньшей емкости разница может появиться. Кроме того, есть заслуживающая доверия информация, что это не совсем TLC, а eTLC — то есть отборные кристаллы, используемые, например, в серверных накопителях линеек Toshiba PM5 или некоторых моделях Seagate Nytro. Правда, заявленный ресурс в данном случае, напротив, низковат. Впрочем, он все равно заметно выше, чем это «принято» в массовом сегменте: напомним, что при той же емкости у Samsung 860 Evo речь идет о 600 ТБ, у Intel 545s заявлено 576 ТБ, у WD Blue 3D — лишь 400 ТБ, а у Crucial MX500 — и вовсе 360 ТБ при той же пятилетней гарантии. В общем, и при использовании по прямому назначению (то есть при постоянной записи данных) можно не волноваться. Но получилось не слишком быстро, так что для такой конфигурации лучше подошел бы какой-нибудь восьмиканальный контроллер с DRAM-буфером.

Хотя... актуально это было бы при разработке накопителя универсального назначения, а на практике в Hikvision решали более узкую задачу: создание устройства для систем видеонаблюдения. Причем систем видеонаблюдения неординарных — когда винчестеров уже мало, и покупатели готовы доплачивать за флэш (так получился V100) или готовы доплачивать много за большой гарантийный ресурс (V210). А все, что выходит за рамки необходимого, естественно, не учитывалось. Но в первом приближении любые SSD взаимозаменяемы, поэтому мы можем, например, «погонять» всю тройку в обычном «компьютерном» окружении и посмотреть, как это работает. Вдруг в каких-то случаях будет оправдано и нецелевое использование?
Тестирование
Методика тестирования

Методика подробно описана в отдельной статье. Там можно познакомиться с используемым аппаратным и программным обеспечением.
Образцы для сравнения

Возникает, правда, одна проблема: SATA-терабайтники мы практически не тестировали (особенно бюджетные конфигурации), так что сравнить эти SSD Hikvision почти не с кем. С другой стороны, у нас есть результаты Toshiba TR200 960 ГБ: во-первых, это один из первых накопителей на базе 64-слойной BiCS3 3D TLC NAND, а во-вторых, используется в нем контроллер Phison S11 — как раз бюджетное безбуферное решение, напрямую конкурирующее с Silicon Motion SM2258XT и Maxio MAS0902A. В чем-то даже уступающее, ибо всего два канала памяти против четырех. Вот и сравним на практике. В качестве второго ориентира возьмем Samsung 860 Evo на 1 ТБ: накопитель более высокого класса, зато многим хорошо знакомый и предсказуемый. Кстати, стоит он практически как V100, а V210 нередко оказывается даже дороже, чем 860 Pro — фактически топ в сегменте, благодаря использованию MLC-памяти. Поэтому его тоже добавим к списку испытуемых.
Производительность в приложениях

Как уже не раз было отмечено, с точки зрения «чтоб система быстро бегала» практически все SSD одинаковы — поскольку ее в способности бегать не ограничивают. В отличие от жестких дисков — хотя емкости тут уже сопоставимые, так что остается только цена. Других противопоказаний, например, к замене терабайтного винчестера на недорогой SSD той же емкости в ноутбуке не осталось.

Причем не выходя за пределы «класса» и в потенциальном быстродействии большую разницу получить невозможно: тут уже ограничения SATA600 сказываются. Понятно, что бюджетные контроллеры сами по себе их только усиливают, но разница не столь уж и велика. И цене не пропорциональна — во всех смыслах.

Предыдущая версия пакета отличается лишь тем, что в ней TR200 побыстрее С100, а PCMark 8 утверждал обратное. Но в целом — решения одного класса. Да и Maxiotek — того же же. Хотя при «правильном подходе» может работать быстрее. Или даже заметно быстрее, но это побочный эффект скорее, нежели основной.
Последовательные операции

Накопители на SM2258XT (и подобных моделях Silicon Motion) обычно даже снижают производительность в многопоточном режиме, что является их особенностью, а не проявлением «безбуферности». Впрочем, Phison S11 при таких нагрузках тоже не рекордсмен, т. е. даже при чтении данных (которое, казалось бы, операция для всех простая) бюджетные накопители могут и не достигать возможностей SATA600. Но могут и достигать — что показали V100 и V210 (да — формально конкретно их к «бюджетным» отнести сложно, но платформа, в общем-то как раз такая).

А вот «провал» в многопоточной записи следствием отсутствия DRAM считать можно. Почему его нет у С100? Вспоминаем особенность SM2258XT: все данные проходят через кэш, а на пустом накопителе его много, поскольку ограничен лишь свободным местом. Правда и недостатки этой синтетической победы выше упомянуты были.
Случайный доступ

Эти сценарии «любят» многие читатели — но на дух не переносят все безбуферные контроллеры. Phison S11 тут чуть в лучшем положении из-за наличия 32 МБ встроенной памяти, но при сегодняшних емкостях это, конечно, маловато. Справедливости ради, на практике «длинные» очереди вообще редкость, так что «попугаи» на них не так уж и важны. А на коротких разброс результатов существенно уменьшается.
Работа с большими файлами

Особых отличий от низкоуровневых тестов нет — читают все быстро. За исключением TR200, но законы физики обмануть невозможно — всего два канала контроллера не позволяют масштабировать скорость по объему, а на терабайтной отметке это имеет значение.

С записью все на первый взгляд также. Если не вспоминать о том, что для С100 это лучший случай — объем записываемых данных не превышает количество доступного SLC-кэша. Если же заполнить накопитель «до упора», места для него почти не останется — и получим мы менее 100 МБ/с. Почему такие накопители и не подходят для непрерывной потоковой записи. А V100 и V210 — подходят. Пусть и работают медленнее, чем накопители универсального назначения, но более высокого класса.

Причем при записи одновременно с чтением даже агрессивное кэширование не слишком спасает С100. А, глядя на результаты V-серии, можно сделать вывод, что при такой емкости его как раз вообще лучше отключить. Даже пиковые скорости не снизятся — а все остальные вообще подрастут. Но в безбуферных продуктах Silicon Motion на данный момент это невозможно. А зря.
Рейтинги

Как уже было сказано, в Hikvision решали конкретную задачу — добиться стабильной скорости при потоковой записи данных, причем минимальной (для себя) ценой. MAS0902A сделать это позволяет. А остальные скоростные характеристики компанию не слишком интересовали, так что где как получилось — так и получилось. Принципиально ничего не изменилось, даже при таких настройках кэширования старшие модели — это все-таки бюджетники по духу. Но бюджетники неплохие, надо заметить.

В общем-то, для «системных» нагрузок подходят любые твердотельные накопители, включая и бюджетные модели. Кроме того, хорошо видно, что производительность таковых практически не масштабируется «по объему» — этого не позволяют сами контроллеры. Поэтому DRAM-less-контроллеры в комплекте с терабайтом-другим памяти... Право на существование такие накопители, конечно, имеют, но в основном в специфических случаях. И V-серия Hikvision как раз иллюстрирует данный случай: это недорогие (конструктивно) накопители, нормально и без сюрпризов справляющиеся с большими объемами потоковой записи. Вроде бы не так уж и много — но не так уж и мало, учитывая, что подход «все данные через кэш» встречается и в некоторых моделях на базе контроллеров «среднего класса» того же Silicon Motion. А при выборе универсального накопителя экономия на контроллере может быть оправдана, как нам кажется, только в рамках глобальной экономии на всем, включая емкость.
Итого

По сути, с выводов мы эту статью и начали: «тюнинг» твердотельных накопителей не только лишь возможен, но и достаточно прост. По большому счету, даже небольшие изменения прошивки могут существенно изменить поведение устройства. Но хорошо видно, что такие изменения все-таки относятся к частным сценариям. Нужны были компании недорогие накопители, пригодные для потоковой записи — именно эта задача и решалась. На прочих скоростных характеристиках изменения сказались слабо (так что, пользуясь случаем, хочется передать привет секте свидетелей скорости записи за пределами SLC-кэша :)) — но такая цель и не ставилась. В этой связи даже оценивать розничные цены устройств не имеет смысла — те же V210 в первую очередь сделаны не на продажу (недаром их даже не снабжают красивой коробочкой), а для законченных инсталляций систем видеонаблюдения высокого класса, например. Все остальное оборудование в ассортименте Hikvision было и раньше, накопители его пополнили, а сколько конкретно они стоят, в данном случае не слишком важно, поскольку значение имеет лишь конечная цена законченного проекта (с учетом всех скидок и наоборот). В то же время, Hikvision V100, похоже, сделан по принципу «и себе, и людям», так что в рознице встречается шире, да и цены не столь обескураживающие. Впрочем, с учетом «начинки» цены все равно выглядят немного странно — вряд ли себестоимость этой линейки отличается от C100. Скорее, это доплата за предсказуемость скорости записи, которой от многих бюджетных накопителей ожидать не приходится. А тут устройство, гарантированно справляющееся с работой в сервере видеонаблюдения, например, или во внешнем накопителе, причем независимо от степени «заполненности». В любом случае цены (особенно розничные) — это совершенно отдельная тема, не слишком интересная с точки зрения повышения общей образованности. Нам было важнее посмотреть, какими способами можно сделать SSD для видеонаблюдения. Оказалось — что простыми и недорогими (для производителя).
